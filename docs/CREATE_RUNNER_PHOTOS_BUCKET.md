# üì¶ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠: ‡∏™‡∏£‡πâ‡∏≤‡∏á Storage Bucket ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡πà‡∏á

‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á Storage Bucket ‡∏ä‡∏∑‡πà‡∏≠ `runner_photos` ‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô

---

## üéØ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

Storage Bucket ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÇ‡∏î‡∏¢:
- **Public Access:** ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ (‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏ö‡πÑ‡∏î‡πâ)
- **Upload/Update/Delete:** ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ authenticated users (admin) ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

---

## üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Bucket

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà Storage ‡πÉ‡∏ô Supabase Dashboard

1. ‡πÄ‡∏õ‡∏¥‡∏î [Supabase Dashboard](https://app.supabase.com)
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Project `runnerpao`
3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà **Storage** ‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ (‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏£‡∏π‡∏õ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå)

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Bucket ‡πÉ‡∏´‡∏°‡πà

1. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° **"New bucket"** ‡∏´‡∏£‡∏∑‡∏≠ **"Create a new bucket"** (‡∏°‡∏∏‡∏°‡∏ö‡∏ô‡∏Ç‡∏ß‡∏≤)

2. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Bucket:

   ```
   Name: runner_photos
   ```
   
   **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á (‡πÉ‡∏ä‡πâ underscore _ ‡πÅ‡∏ó‡∏ô)

3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:
   
   **‚úÖ Public bucket:** ‡πÄ‡∏õ‡∏¥‡∏î (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á authenticate)
   
   ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•: ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡πà‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ BibPassDisplay ‡πÑ‡∏î‡πâ

4. (Optional) ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:
   ```
   File size limit: 5 MB
   Allowed MIME types: image/jpeg, image/png, image/webp
   ```

5. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Create bucket"**

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Storage Policies

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á bucket ‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ policies ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á

#### A. ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Policies

1. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà bucket `runner_photos` ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏ó‡πá‡∏ö **"Policies"** (‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô)
3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° **"New Policy"**

---

#### B. ‡∏™‡∏£‡πâ‡∏≤‡∏á Policy ‡∏ó‡∏µ‡πà 1: Public Read (‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ)

1. ‡∏Ñ‡∏•‡∏¥‡∏Å **"New Policy"**
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"For full customization"** ‡∏´‡∏£‡∏∑‡∏≠ **"Create a policy from scratch"**
3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:

   **Policy name:**
   ```
   Public Access - Allow everyone to read
   ```

   **Allowed operation:**
   - ‚úÖ SELECT (‡∏≠‡πà‡∏≤‡∏ô)

   **Target roles:**
   - ‚úÖ public
   - ‚úÖ anon
   - ‚úÖ authenticated

   **USING expression (Policy check):**
   ```sql
   bucket_id = 'runner_photos'
   ```

4. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Review"** ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å **"Save policy"**

**‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ SQL ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô SQL Editor:**
```sql
CREATE POLICY "Public Access for runner photos"
ON storage.objects FOR SELECT
USING ( bucket_id = 'runner_photos' );
```

---

#### C. ‡∏™‡∏£‡πâ‡∏≤‡∏á Policy ‡∏ó‡∏µ‡πà 2: Authenticated Upload (‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ authenticated users ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ)

1. ‡∏Ñ‡∏•‡∏¥‡∏Å **"New Policy"** ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"Create a policy from scratch"**
3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:

   **Policy name:**
   ```
   Authenticated Upload - Allow admins to upload
   ```

   **Allowed operation:**
   - ‚úÖ INSERT (‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà)

   **Target roles:**
   - ‚úÖ authenticated

   **WITH CHECK expression:**
   ```sql
   bucket_id = 'runner_photos'
   ```

4. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Review"** ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å **"Save policy"**

**‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ SQL ‡∏ô‡∏µ‡πâ:**
```sql
CREATE POLICY "Authenticated users can upload runner photos"
ON storage.objects FOR INSERT
TO authenticated
WITH CHECK ( bucket_id = 'runner_photos' );
```

---

#### D. ‡∏™‡∏£‡πâ‡∏≤‡∏á Policy ‡∏ó‡∏µ‡πà 3: Authenticated Update (‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ)

**SQL:**
```sql
CREATE POLICY "Authenticated users can update runner photos"
ON storage.objects FOR UPDATE
TO authenticated
USING ( bucket_id = 'runner_photos' );
```

---

#### E. ‡∏™‡∏£‡πâ‡∏≤‡∏á Policy ‡∏ó‡∏µ‡πà 4: Authenticated Delete (‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏•‡∏ö‡πÑ‡∏î‡πâ)

**SQL:**
```sql
CREATE POLICY "Authenticated users can delete runner photos"
ON storage.objects FOR DELETE
TO authenticated
USING ( bucket_id = 'runner_photos' );
```

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

#### A. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Bucket

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Storage** > ‡∏Ñ‡∏•‡∏¥‡∏Å **runner_photos**
2. ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô bucket ‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

#### B. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Policies

1. ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏ó‡πá‡∏ö **"Policies"**
2. ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô policies ‡∏ó‡∏±‡πâ‡∏á 4 ‡∏ï‡∏±‡∏ß:
   - ‚úÖ Public Access (SELECT)
   - ‚úÖ Authenticated Upload (INSERT)
   - ‚úÖ Authenticated Update (UPDATE)
   - ‚úÖ Authenticated Delete (DELETE)

#### C. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ BibPassDisplay ‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡πà‡∏á‡∏Ñ‡∏ô‡πÉ‡∏î‡∏Å‡πá‡πÑ‡∏î‡πâ
2. ‡∏•‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
3. ‡∏ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô bucket `runner_photos`

---

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ SQL ‡∏™‡∏£‡πâ‡∏≤‡∏á Policies ‡πÅ‡∏ö‡∏ö‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á policies ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô ‡πÉ‡∏ä‡πâ SQL ‡∏ô‡∏µ‡πâ:

```sql
-- ============================================
-- Storage Policies ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö runner_photos Bucket
-- ============================================

-- Policy 1: ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ (Public Read)
CREATE POLICY "Public Access for runner photos"
ON storage.objects FOR SELECT
USING ( bucket_id = 'runner_photos' );

-- Policy 2: ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ authenticated users ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ (Upload)
CREATE POLICY "Authenticated users can upload runner photos"
ON storage.objects FOR INSERT
TO authenticated
WITH CHECK ( bucket_id = 'runner_photos' );

-- Policy 3: ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ authenticated users ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ (Update)
CREATE POLICY "Authenticated users can update runner photos"
ON storage.objects FOR UPDATE
TO authenticated
USING ( bucket_id = 'runner_photos' );

-- Policy 4: ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ authenticated users ‡∏•‡∏ö‡πÑ‡∏î‡πâ (Delete)
CREATE POLICY "Authenticated users can delete runner photos"
ON storage.objects FOR DELETE
TO authenticated
USING ( bucket_id = 'runner_photos' );

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ policies ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
SELECT 
    schemaname,
    tablename,
    policyname,
    roles,
    cmd
FROM pg_policies 
WHERE tablename = 'objects' 
  AND policyname LIKE '%runner photos%'
ORDER BY policyname;
```

‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ:
1. ‡πÄ‡∏õ‡∏¥‡∏î **SQL Editor** ‡πÉ‡∏ô Supabase Dashboard
2. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å SQL ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
3. ‡∏ß‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏Å **"Run"** (Ctrl+Enter)
4. ‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!

---

## üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Bucket URL

‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à URL ‡∏Ç‡∏≠‡∏á bucket ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô:

```
https://[project-ref].supabase.co/storage/v1/object/public/runner_photos/[file-path]
```

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
```
https://jvghgllatudnusmcrmcb.supabase.co/storage/v1/object/public/runner_photos/1736438472000_runner_001.jpg
```

---

## üìä ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

```
runner_photos/
‚îú‚îÄ‚îÄ 1736438472000_runner_001.jpg
‚îú‚îÄ‚îÄ 1736438473000_runner_002.jpg
‚îú‚îÄ‚îÄ 1736438474000_runner_003.jpg
‚îî‚îÄ‚îÄ ...
```

‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô: `[timestamp]_[original-filename].[ext]`

---

## üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå

### ‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô Bucket

```sql
SELECT 
    name,
    bucket_id,
    created_at,
    updated_at,
    last_accessed_at,
    metadata->>'size' as size_bytes
FROM storage.objects
WHERE bucket_id = 'runner_photos'
ORDER BY created_at DESC;
```

### ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß

```sql
-- ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ runner ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß (orphaned files)
DELETE FROM storage.objects
WHERE bucket_id = 'runner_photos'
  AND name NOT IN (
    SELECT SUBSTRING(runner_photo_url FROM 'runner_photos/(.+)$')
    FROM runners
    WHERE runner_photo_url IS NOT NULL
      AND runner_photo_url LIKE '%runner_photos/%'
  );
```

---

## üÜò Troubleshooting

### ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Bucket ‡πÑ‡∏°‡πà public
- Policies ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ login (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö authenticated upload)

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ bucket ‡πÄ‡∏õ‡πá‡∏ô public
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö policies ‡∏ß‡πà‡∏≤‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 4 ‡∏ï‡∏±‡∏ß
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ login ‡πÅ‡∏•‡πâ‡∏ß (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô authenticated user)

### ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏£‡∏π‡∏õ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Bucket ‡πÑ‡∏°‡πà public
- URL ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ bucket ‡πÄ‡∏õ‡πá‡∏ô public
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:
   ```
   https://[project-ref].supabase.co/storage/v1/object/public/runner_photos/[filename]
   ```

### ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Error "RLS policy violation"

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Policies ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
- ‡∏•‡∏ö policies ‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà:
  ```sql
  -- ‡∏•‡∏ö policies ‡πÄ‡∏î‡∏¥‡∏°
  DROP POLICY IF EXISTS "Public Access for runner photos" ON storage.objects;
  DROP POLICY IF EXISTS "Authenticated users can upload runner photos" ON storage.objects;
  
  -- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà (‡πÉ‡∏ä‡πâ SQL ‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô)
  ```

---

## üìö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á

- [Supabase Storage Documentation](https://supabase.com/docs/guides/storage)
- [Storage Policies Documentation](https://supabase.com/docs/guides/storage/security/access-control)
- [RUNNER_PHOTO_SETUP.md](./RUNNER_PHOTO_SETUP.md) - ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡πà‡∏á

---

## ‚úÖ Checklist

- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á bucket `runner_photos` ‡πÅ‡∏•‡πâ‡∏ß
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô Public bucket
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Policy: Public Read (SELECT)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Policy: Authenticated Upload (INSERT)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Policy: Authenticated Update (UPDATE)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Policy: Authenticated Delete (DELETE)
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡πâ‡∏ß
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡πâ‡∏ß

---

**‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢:** Project-Fang Team  
**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:** 2026-01-09

